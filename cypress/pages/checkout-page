/// <reference types="cypress" />

class CheckoutPage {
  // Fill shipping details form
  fillShippingDetails(userData) {
    cy.get('input[name="firstname"]').clear().type(userData.firstName);
    cy.get('input[name="lastname"]').clear().type(userData.lastName);
    cy.get('input[name="company"]').clear();
    cy.get('input[name="street[0]"]').clear().type(userData.address);
    cy.get('input[name="city"]').clear().type(userData.city);
    cy.get('select[name="region_id"]').select(userData.region);
    cy.get('input[name="postcode"]').clear().type(userData.postcode);
    cy.get('select[name="country_id"]').select(userData.country);
    cy.get('input[name="telephone"]').clear().type(userData.phone);
    cy.get('button.continue').click(); // Continue to shipping method
    return this;
  }

  // Select shipping method (assumes first available)
  selectShippingMethod() {
    cy.get('input[name="ko_unique_1"]').first().check({ force: true });
    cy.get('button.continue').click(); // Continue to payment
    return this;
  }

  // Place the order
  placeOrder() {
    cy.get('button[title="Place Order"]').click();
    return this;
  }

  // Assert order success
  assertOrderSuccess() {
    cy.get('.checkout-success').should('be.visible');
    cy.contains('Thank you for your purchase').should('be.visible');
    return this;
  }
}

export default new CheckoutPage();